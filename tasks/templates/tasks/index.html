{% extends 'tasks/base.html' %}
{% block title %}Tasks - To-Do App{% endblock %}

{% block content %}
<div class="mb-6">
  <form method="get" class="grid grid-cols-12 gap-4 items-center">
    <div class="col-span-8">
      <input
        name="q"
        value="{{ q }}"
        placeholder="Search tasks..."
        class="w-full h-12 rounded-xl bg-[#19142f] border border-white/6 px-4 text-gray-200 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-violet-500 transition"
      />
    </div>

    <div class="col-span-2">
      <select name="status" class="w-full h-12 rounded-xl bg-[#19142f] border border-white/6 px-3 text-gray-200">
        <option value="all" {% if filter_status == 'all' %}selected{% endif %}>All</option>
        <option value="pending" {% if filter_status == 'pending' %}selected{% endif %}>Pending</option>
        <option value="done" {% if filter_status == 'done' %}selected{% endif %}>Done</option>
      </select>
    </div>

    <div class="col-span-2 text-right">
      <button type="submit" class="h-12 px-5 rounded-xl bg-gradient-to-br from-violet-500 via-purple-600 to-indigo-600 text-white font-semibold btn-neon">Filter</button>
    </div>
  </form>
</div>

<div class="flex justify-end text-sm text-gray-300 mb-4">Total: <span class="ml-2 font-medium text-gray-100">{{ tasks.count }}</span></div>

{% if tasks %}
  <div class="space-y-5">
    {% for task in tasks %}
      <article class="relative rounded-2xl p-6 bg-gradient-to-br from-[#14102b] to-[#1b1440] border border-white/6 card-neon overflow-hidden">
        <!-- left accent strip (color depends on status) -->
        <div class="accent-strip" style="{% if task.completed %}background:linear-gradient(180deg,#10b981,#059669);{% else %}background:linear-gradient(180deg,#7c3aed,#2563eb);{% endif %}"></div>

        <div class="flex justify-between items-start gap-6">
          <div class="flex-1 pr-4">
            <h3 class="text-lg font-semibold text-white">{{ task.title }}</h3>
            {% if task.description %}
              <p class="mt-2 text-gray-300">{{ task.description }}</p>
            {% endif %}
            <div class="mt-3 text-sm text-gray-400">Created: {{ task.created_at|date:"SHORT_DATETIME_FORMAT" }}</div>
          </div>

          <div class="flex flex-col items-end gap-3">
            {% if task.completed %}
              <div class="text-emerald-300 bg-emerald-900/10 px-3 py-1 rounded-full text-sm font-semibold border border-emerald-600">Done</div>
            {% else %}
              <div class="text-indigo-200 bg-indigo-900/10 px-3 py-1 rounded-full text-sm font-semibold border border-indigo-600">Pending</div>
            {% endif %}

            <div class="flex gap-3">
              <a href="{% url 'tasks:toggle' task.pk %}" class="px-3 py-1.5 rounded-md border border-emerald-600 text-emerald-300 hover:bg-emerald-600/20 transition"> {{ task.completed|yesno:"Undo,Done" }} </a>
              <a href="{% url 'tasks:edit' task.pk %}" class="px-3 py-1.5 rounded-md border border-indigo-600 text-indigo-200 hover:bg-indigo-600/20 transition">Edit</a>
              <a href="{% url 'tasks:delete' task.pk %}" class="px-3 py-1.5 rounded-md border border-rose-600 text-rose-400 hover:bg-rose-600/20 transition">Delete</a>
            </div>
          </div>
        </div>
      </article>
    {% endfor %}
  </div>
{% else %}
  <div class="text-center py-16">
    <h4 class="text-xl font-semibold text-gray-100 mb-2">No tasks yet</h4>
    <p class="text-gray-400 mb-4">Create your first task to get started.</p>
    <a href="{% url 'tasks:create' %}" class="inline-flex items-center gap-2 px-4 py-2 rounded-xl bg-gradient-to-br from-violet-500 via-purple-600 to-indigo-600 text-white btn-neon">Create Task</a>
  </div>
{% endif %}
{% endblock %}
